"use strict";(self.webpackChunksupastash_docs=self.webpackChunksupastash_docs||[]).push([[2140],{4827:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"fetchPolicy","title":"Fetch Policies","description":"\u26a1 How cacheFirst() Works","source":"@site/docs/fetchPolicy.md","sourceDirName":".","slug":"/fetchPolicy","permalink":"/supastash/docs/fetchPolicy","draft":false,"unlisted":false,"editUrl":"https://github.com/0xZekeA/supastash/tree/main/docs-site/docs/fetchPolicy.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Supastash Filters","permalink":"/supastash/docs/supastash-filters"},"next":{"title":".insert() method","permalink":"/supastash/docs/insert-query"}}');var n=t(4848),i=t(8453);const a={},o="Fetch Policies",c={},l=[{value:"\u26a1 How <code>cacheFirst()</code> Works",id:"-how-cachefirst-works",level:2},{value:"\ud83d\udee0\ufe0f Code Example",id:"\ufe0f-code-example",level:2},{value:"\ud83d\udcca Comparison: When to use Cache-First?",id:"-comparison-when-to-use-cache-first",level:2},{value:"\ud83d\udca1 Best Use Cases",id:"-best-use-cases",level:2},{value:"\u26a0\ufe0f Important Note on &quot;Stale&quot; Data",id:"\ufe0f-important-note-on-stale-data",level:3}];function d(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"fetch-policies",children:"Fetch Policies"})}),"\n",(0,n.jsxs)(s.h2,{id:"-how-cachefirst-works",children:["\u26a1 How ",(0,n.jsx)(s.code,{children:"cacheFirst()"})," Works"]}),"\n",(0,n.jsx)(s.p,{children:"When you execute a query with this policy, Supastash follows a specific sequence:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Check Local DB:"})," It searches your local SQLite storage for the requested data."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Return if Found:"})," If the data exists locally, it is returned ",(0,n.jsx)(s.strong,{children:"immediately"}),". No network request is made."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Fetch from Remote:"})," If the data is ",(0,n.jsx)(s.strong,{children:"not"})," found locally (e.g., a cache miss), it performs a network request to your remote database (Supabase)."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Update Local DB:"})," Once the remote data arrives, it is saved locally for future requests."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Return Remote Data:"})," Finally, the data is returned to your application."]}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"\ufe0f-code-example",children:"\ud83d\udee0\ufe0f Code Example"}),"\n",(0,n.jsx)(s.p,{children:"This is ideal for data that doesn't change every second, like user profiles or historical orders."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-typescript",children:'const { data, error } = await supastash\n  .from("orders")\n  .select("*")\n  .eq("status", "completed")\n  .cacheFirst() // \ud83d\udc48 The magic happens here\n  .run();\n\n// If "completed orders" are already in SQLite,\n// this returns in ~5ms instead of ~200ms+.\n'})}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"-comparison-when-to-use-cache-first",children:"\ud83d\udcca Comparison: When to use Cache-First?"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Feature"}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.code,{children:"cacheFirst()"})}),(0,n.jsx)(s.th,{children:(0,n.jsx)(s.code,{children:"networkOnly()"})})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Speed"})}),(0,n.jsxs)(s.td,{children:["\ud83d\ude80 ",(0,n.jsx)(s.strong,{children:"Fastest"})," (Local Read)"]}),(0,n.jsxs)(s.td,{children:["\ud83d\udc22 ",(0,n.jsx)(s.strong,{children:"Slower"})," (Network Latency)"]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Offline"})}),(0,n.jsx)(s.td,{children:"\u2705 Works offline if data exists"}),(0,n.jsx)(s.td,{children:"\u274c Fails without internet"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Freshness"})}),(0,n.jsx)(s.td,{children:"\u26a0\ufe0f May be outdated"}),(0,n.jsx)(s.td,{children:"\u2728 Always up-to-date"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Data Usage"})}),(0,n.jsx)(s.td,{children:"\ud83d\udcc9 Saves bandwidth"}),(0,n.jsx)(s.td,{children:"\ud83d\udcc8 High bandwidth usage"})]})]})]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h2,{id:"-best-use-cases",children:"\ud83d\udca1 Best Use Cases"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Static Metadata:"})," Categories, app configurations, or country lists."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"User History:"})," Past orders or archived messages that rarely change."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Offline Support:"})," Ensuring the app remains functional when the user loses their connection."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Reducing Costs:"})," Minimizing API calls to your Supabase project to stay within free-tier limits or reduce egress."]}),"\n"]}),"\n",(0,n.jsx)(s.hr,{}),"\n",(0,n.jsx)(s.h3,{id:"\ufe0f-important-note-on-stale-data",children:'\u26a0\ufe0f Important Note on "Stale" Data'}),"\n",(0,n.jsxs)(s.p,{children:["Because ",(0,n.jsx)(s.code,{children:"cacheFirst()"})," stops once it finds data locally, it will ",(0,n.jsx)(s.strong,{children:"not"})," check if that data has changed on the server. If you need the latest data while still showing local data instantly, consider using a ",(0,n.jsx)(s.strong,{children:'"Stale-While-Revalidate"'})," approach (often called ",(0,n.jsx)(s.code,{children:"cacheAndNetwork"})," in other libraries)."]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>a,x:()=>o});var r=t(6540);const n={},i=r.createContext(n);function a(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);