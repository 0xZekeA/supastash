"use strict";(self.webpackChunksupastash_docs=self.webpackChunksupastash_docs||[]).push([[7924],{6475:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"getting-started","title":"\ud83d\ude80 Getting Started with Supastash","description":"Supastash helps you build offline-first apps by syncing local SQLite data with Supabase in the background. This guide walks you through setting it up from scratch.","source":"@site/docs/getting-started.md","sourceDirName":".","slug":"/getting-started","permalink":"/supastash/docs/getting-started","draft":false,"unlisted":false,"editUrl":"https://github.com/0xZekeA/supastash/tree/main/docs-site/docs/getting-started.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","next":{"title":"Supastash Query Builder","permalink":"/supastash/docs/supastash-query-builder"}}');var a=n(4848),r=n(8453);const i={},l="\ud83d\ude80 Getting Started with Supastash",d={},o=[{value:"\ud83d\udce6 Installation",id:"-installation",level:2},{value:"1. Install Supastash",id:"1-install-supastash",level:3},{value:"2. Install Required Peer Dependencies",id:"2-install-required-peer-dependencies",level:3},{value:"3. Choose a SQLite Adapter (Only ONE)",id:"3-choose-a-sqlite-adapter-only-one",level:3},{value:"\u2699\ufe0f Project Setup",id:"\ufe0f-project-setup",level:2},{value:"1. Create the Supastash Config",id:"1-create-the-supastash-config",level:3},{value:"2. Initialize It Once (in your main layout)",id:"2-initialize-it-once-in-your-main-layout",level:3},{value:"\ud83d\udee1\ufe0f Server-Side Setup for RLS",id:"\ufe0f-server-side-setup-for-rls",level:2},{value:"Important Timestamp Rule",id:"important-timestamp-rule",level:3},{value:"\u2699\ufe0f Bootstrapping the Sync Engine",id:"\ufe0f-bootstrapping-the-sync-engine",level:2},{value:"\ud83e\uddea Basic Hook Usage: <code>useSupatashData</code>",id:"-basic-hook-usage-usesupatashdata",level:2},{value:"\ud83e\udde9 <code>extraMapKeys</code>: Smarter Derived Maps \u2014 for Free",id:"-extramapkeys-smarter-derived-maps--for-free",level:3},{value:"\ud83d\udd0d With Filtering",id:"-with-filtering",level:2},{value:"\ud83d\udd27 Querying Supabase Directly",id:"-querying-supabase-directly",level:2},{value:"\ud83d\udccb Monitoring &amp; Debugging",id:"-monitoring--debugging",level:3},{value:"\ud83e\udde0 Next Steps",id:"-next-steps",level:2}];function c(e){const s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"-getting-started-with-supastash",children:"\ud83d\ude80 Getting Started with Supastash"})}),"\n",(0,a.jsxs)(s.p,{children:["Supastash helps you build ",(0,a.jsx)(s.strong,{children:"offline-first apps"})," by syncing local SQLite data with Supabase in the background. This guide walks you through setting it up from scratch."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"-installation",children:"\ud83d\udce6 Installation"}),"\n",(0,a.jsx)(s.h3,{id:"1-install-supastash",children:"1. Install Supastash"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"npm install supastash\n"})}),"\n",(0,a.jsx)(s.h3,{id:"2-install-required-peer-dependencies",children:"2. Install Required Peer Dependencies"}),"\n",(0,a.jsxs)(s.p,{children:["These are required and ",(0,a.jsx)(s.strong,{children:"must be installed manually"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"npm install @supabase/supabase-js \\\n             @react-native-community/netinfo \\\n             react \\\n             react-native\n"})}),"\n",(0,a.jsx)(s.h3,{id:"3-choose-a-sqlite-adapter-only-one",children:"3. Choose a SQLite Adapter (Only ONE)"}),"\n",(0,a.jsx)(s.p,{children:"Choose based on your project type:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"# For Expo projects\nnpm install expo-sqlite\n\n# For better performance in bare React Native\nnpm install react-native-nitro-sqlite\n\n# Or use the classic SQLite option\nnpm install react-native-sqlite-storage\n"})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"\ufe0f-project-setup",children:"\u2699\ufe0f Project Setup"}),"\n",(0,a.jsx)(s.h3,{id:"1-create-the-supastash-config",children:"1. Create the Supastash Config"}),"\n",(0,a.jsxs)(s.p,{children:["Setup early in your app \u2014 e.g., ",(0,a.jsx)(s.code,{children:"lib/supastash.ts"})]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'import { configureSupastash, defineLocalSchema } from "supastash";\nimport { supabase } from "./supabase";\nimport { openDatabaseAsync } from "expo-sqlite"; // or nitro/sqlite-storage client\n\nconfigureSupastash({\n  supabaseClient: supabase,\n  dbName: "supastash_db",\n  sqliteClient: { openDatabaseAsync },\n  sqliteClientType: "expo", // or "rn-nitro" / "rn-storage"\n\n  onSchemaInit: () => {\n    defineLocalSchema("users", {\n      id: "TEXT PRIMARY KEY",\n      name: "TEXT",\n      email: "TEXT",\n      created_at: "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",\n      updated_at: "TIMESTAMP DEFAULT CURRENT_TIMESTAMP",\n    });\n  },\n\n  debugMode: true,\n  syncEngine: {\n    push: true,\n    pull: false, // Enable if using RLS and want to pull filtered data\n  },\n  excludeTables: {\n    push: ["daily_reminders"],\n    pull: ["daily_reminders"],\n  },\n});\n'})}),"\n",(0,a.jsx)(s.h3,{id:"2-initialize-it-once-in-your-main-layout",children:"2. Initialize It Once (in your main layout)"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'// App.tsx or _layout.tsx\nimport "@/lib/supastash"; // Just import to initialize\n\nexport default function App() {\n  return <Stack />; // or your main app entry\n}\n'})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"\ufe0f-server-side-setup-for-rls",children:"\ud83d\udee1\ufe0f Server-Side Setup for RLS"}),"\n",(0,a.jsxs)(s.p,{children:["Supastash needs access to your table schema. Run this ",(0,a.jsx)(s.strong,{children:"SQL function"})," in the Supabase SQL Editor:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-sql",children:"create or replace function get_table_schema(table_name text)\nreturns table(\n  column_name text,\n  data_type text,\n  is_nullable text\n)\nsecurity definer\nas $$\n  select column_name, data_type, is_nullable\n  from information_schema.columns\n  where table_schema = 'public' and table_name = $1;\n$$ language sql;\n\ngrant execute on function get_table_schema(text) to anon, authenticated;\n"})}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:["\u2705 This works with ",(0,a.jsx)(s.strong,{children:"Row-Level Security (RLS)"}),". Without this, Supastash can't sync filtered data."]}),"\n"]}),"\n",(0,a.jsx)(s.h3,{id:"important-timestamp-rule",children:"Important Timestamp Rule"}),"\n",(0,a.jsxs)(s.p,{children:["All timestamp columns used for syncing \u2014 like ",(0,a.jsx)(s.code,{children:"created_at"}),", ",(0,a.jsx)(s.code,{children:"updated_at"}),", ",(0,a.jsx)(s.code,{children:"deleted_at"})," \u2014 ",(0,a.jsxs)(s.strong,{children:["must be ",(0,a.jsx)(s.code,{children:"timestamptz"})]})," (timestamp with time zone)."]}),"\n",(0,a.jsx)(s.p,{children:"This prevents timezone issues and ensures reliable sync."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"\ufe0f-bootstrapping-the-sync-engine",children:"\u2699\ufe0f Bootstrapping the Sync Engine"}),"\n",(0,a.jsx)(s.p,{children:"Before rendering your app, make sure the Supastash engine is ready:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'// App.tsx or _layout.tsx\nimport { useSupatash } from "supastash";\n\nconst { dbReady } = useSupatash();\nif (!dbReady) return null;\nreturn <Stack />;\n'})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.h2,{id:"-basic-hook-usage-usesupatashdata",children:["\ud83e\uddea Basic Hook Usage: ",(0,a.jsx)(s.a,{href:"/supastash/docs/data-access",children:(0,a.jsx)(s.code,{children:"useSupatashData"})})]}),"\n",(0,a.jsx)(s.p,{children:"This hook gives you live local-first data access."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'import { useSupatashData } from "supastash";\n\ntype Order = {\n  id: string;\n  user_id: string;\n  deleted_at: string | null;\n  updated_at: string;\n  created_at: string;\n};\n\nconst {\n  data: orders,\n  dataMap: ordersMap,\n  groupedBy,\n} = useSupatashData<Order>("orders", { extraMapKeys: ["user_id"] });\n'})}),"\n",(0,a.jsx)(s.p,{children:"You get:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"data"})," \u2013 An array of rows"]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataMap"})," \u2013 A map keyed by ",(0,a.jsx)(s.code,{children:"id"})," for fast lookup"]}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"Supastash keeps this in sync with SQLite and Supabase."}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsxs)(s.h3,{id:"-extramapkeys-smarter-derived-maps--for-free",children:["\ud83e\udde9 ",(0,a.jsx)(s.code,{children:"extraMapKeys"}),": Smarter Derived Maps \u2014 for Free"]}),"\n",(0,a.jsx)(s.p,{children:"Need to group, lookup, or filter your data by a specific column?"}),"\n",(0,a.jsxs)(s.p,{children:["Pass any field(s) into ",(0,a.jsx)(s.code,{children:"extraMapKeys"}),", and Supastash will automatically generate map structures for you \u2014 ",(0,a.jsx)(s.em,{children:"efficiently and in the background"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'const { dataMap, groupedBy } = useSupatashData("orders", {\n  extraMapKeys: ["user_id", "status"],\n});\n'})}),"\n",(0,a.jsx)(s.p,{children:"You get:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"dataMap"}),": Fast lookup by ",(0,a.jsx)(s.code,{children:"id"})]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"groupedBy.user_id"}),": Grouped orders by ",(0,a.jsx)(s.code,{children:"user_id"})]}),"\n",(0,a.jsxs)(s.li,{children:[(0,a.jsx)(s.code,{children:"groupedBy.status"}),": Grouped orders by status"]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["\u2705 No need to ",(0,a.jsx)(s.code,{children:"reduce()"})," or create memoized maps manually\n\u26a1\ufe0f This is optimized to run in sync with the rest of your hook\u2019s data processing \u2014 zero wasted renders."]}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsx)(s.p,{children:"\ud83d\udca1 Use this when rendering lists by user, status, etc."}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"-with-filtering",children:"\ud83d\udd0d With Filtering"}),"\n",(0,a.jsx)(s.p,{children:"Only fetch rows for a specific user:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'import { useSupatashData } from "supastash";\n\nconst { userId } = useAuth();\nconst { data: userOrders } = useSupatashData("orders", {\n  filter: {\n    column: "user_id",\n    operator: "eq",\n    value: userId,\n  },\n  shouldFetch: !!userId,\n});\n'})}),"\n",(0,a.jsxs)(s.p,{children:["This ensures you don\u2019t load data until the ",(0,a.jsx)(s.code,{children:"userId"})," is available."]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h2,{id:"-querying-supabase-directly",children:"\ud83d\udd27 Querying Supabase Directly"}),"\n",(0,a.jsxs)(s.p,{children:["Use ",(0,a.jsx)(s.code,{children:"supastash.from()"})," for one-off server queries (like ",(0,a.jsx)(s.code,{children:"supabase.from(...)"})," but integrated with Supastash):"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:'import { supastash } from "supastash";\n\nuseEffect(() => {\n  const fetchOrders = async () => {\n    const { data, error } = await supastash.from("orders").select("*").run();\n    if (error) console.error(error);\n    else setOrders(data);\n  };\n\n  fetchOrders();\n}, []);\n'})}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.h3,{id:"-monitoring--debugging",children:"\ud83d\udccb Monitoring & Debugging"}),"\n",(0,a.jsxs)(s.p,{children:["Enable ",(0,a.jsx)(s.code,{children:"debugMode: true"})," in ",(0,a.jsx)(s.code,{children:"configureSupastash()"})," to log:"]}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:"When sync starts or fails"}),"\n",(0,a.jsx)(s.li,{children:"Which rows are retried"}),"\n",(0,a.jsx)(s.li,{children:"Offline batching behavior"}),"\n"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-ts",children:"configureSupastash({\n  ...\n  debugMode: true,\n});\n"})}),"\n",(0,a.jsx)(s.p,{children:"This will help during dev to know when things aren\u2019t syncing \u2014 especially useful when testing offline."}),"\n",(0,a.jsx)(s.h2,{id:"-next-steps",children:"\ud83e\udde0 Next Steps"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"/supastash/docs/configuration",children:"Configuration Guide"})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsxs)(s.a,{href:"/supastash/docs/data-access",children:["Data Access Hook (",(0,a.jsx)(s.code,{children:"useSupatashData"}),")"]})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsxs)(s.a,{href:"/supastash/docs/useSupastash-hook",children:["Sync Engine Setup (",(0,a.jsx)(s.code,{children:"useSupatash"}),")"]})}),"\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"/supastash/docs/supastash-query-builder",children:"Supastash Query Builder"})}),"\n"]}),"\n",(0,a.jsx)(s.hr,{}),"\n",(0,a.jsx)(s.p,{children:"That\u2019s it! You\u2019re now set up to build offline-first, realtime-ready apps with Supastash."})]})}function u(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>l});var t=n(6540);const a={},r=t.createContext(a);function i(e){const s=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);