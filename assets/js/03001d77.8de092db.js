"use strict";(self.webpackChunksupastash_docs=self.webpackChunksupastash_docs||[]).push([[4733],{3451:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"supastash-runtime-modes","title":"Runtime Modes","description":"Supastash operates in one of two mutually exclusive runtime modes: Live Mode and Ghost Mode. Understanding these modes is critical for building reliable applications with Supastash.","source":"@site/docs/supastash-runtime-modes.md","sourceDirName":".","slug":"/supastash-runtime-modes","permalink":"/supastash/docs/supastash-runtime-modes","draft":false,"unlisted":false,"editUrl":"https://github.com/0xZekeA/supastash/tree/main/docs-site/docs/supastash-runtime-modes.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Custom Sync Calls","permalink":"/supastash/docs/sync-calls"}}');var r=n(4848),t=n(8453);const a={},l="Runtime Modes",d={},o=[{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Live Mode",id:"live-mode",level:2},{value:"Live Mode Behavior",id:"live-mode-behavior",level:3},{value:"Guarantees",id:"guarantees",level:3},{value:"When to Use",id:"when-to-use",level:3},{value:"Ghost Mode",id:"ghost-mode",level:2},{value:"What Ghost Mode Does",id:"what-ghost-mode-does",level:3},{value:"Database Isolation",id:"database-isolation",level:3},{value:"Data Characteristics",id:"data-characteristics",level:3},{value:"When to Use Ghost Mode",id:"when-to-use-ghost-mode",level:2},{value:"Perfect Use Cases",id:"perfect-use-cases",level:3},{value:"Example Scenario",id:"example-scenario",level:3},{value:"Mode Switching",id:"mode-switching",level:2},{value:"What Happens During a Switch",id:"what-happens-during-a-switch",level:3},{value:"Rules and Guarantees",id:"rules-and-guarantees",level:2},{value:"Invariants",id:"invariants",level:3},{value:"Guarantees You Can Rely On",id:"guarantees-you-can-rely-on",level:3},{value:"Summary",id:"summary",level:2},{value:"Key Takeaways",id:"key-takeaways",level:3}];function c(e){const s={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"runtime-modes",children:"Runtime Modes"})}),"\n",(0,r.jsxs)(s.p,{children:["Supastash operates in one of two mutually exclusive runtime modes: ",(0,r.jsx)(s.strong,{children:"Live Mode"})," and ",(0,r.jsx)(s.strong,{children:"Ghost Mode"}),". Understanding these modes is critical for building reliable applications with Supastash."]}),"\n",(0,r.jsx)(s.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#overview",children:"Overview"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#live-mode",children:"Live Mode"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#ghost-mode",children:"Ghost Mode"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#when-to-use-ghost-mode",children:"When to Use Ghost Mode"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#mode-switching",children:"Mode Switching"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"#rules-and-guarantees",children:"Rules and Guarantees"})}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(s.p,{children:"Runtime modes define how Supastash interacts with core system components:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Local databases"})," \u2013 Isolated database channels per runtime mode"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Remote sync"})," \u2013 Background synchronization with the Supabase backend"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Realtime subscriptions"})," \u2013 Live server driven data updates"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Background jobs"})," \u2013 Retry queues and deferred sync operations"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Network access"})," \u2013 All outbound communication to remote services"]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Key Principle"}),(0,r.jsx)(s.br,{}),"\n","Supastash operates in exactly ",(0,r.jsx)(s.strong,{children:"one"})," runtime mode at any given time.",(0,r.jsx)(s.br,{}),"\n","Switching modes requires a full reinitialization and is intentionally destructive to prevent state leakage and data corruption."]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"live-mode",children:"Live Mode"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Live Mode"})," is the default runtime mode intended for production usage."]}),"\n",(0,r.jsx)(s.h3,{id:"live-mode-behavior",children:"Live Mode Behavior"}),"\n",(0,r.jsx)(s.p,{children:"When running in Live Mode, Supastash:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses the ",(0,r.jsx)(s.strong,{children:"primary local database channel"})]}),"\n",(0,r.jsxs)(s.li,{children:["Executes ",(0,r.jsx)(s.strong,{children:"background synchronization"})," with the Supabase backend"]}),"\n",(0,r.jsxs)(s.li,{children:["Maintains ",(0,r.jsx)(s.strong,{children:"realtime subscriptions"})," when enabled"]}),"\n",(0,r.jsxs)(s.li,{children:["Communicates freely with the ",(0,r.jsx)(s.strong,{children:"remote Supabase services"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Queues and retries"})," failed sync operations automatically"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"guarantees",children:"Guarantees"}),"\n",(0,r.jsx)(s.p,{children:"Live Mode provides the following guarantees:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Guarantee"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Sync durability"})}),(0,r.jsx)(s.td,{children:"Sync operations are never discarded"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Automatic recovery"})}),(0,r.jsx)(s.td,{children:"Failed sync jobs are queued in sqlite and retried"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Network availability"})}),(0,r.jsx)(s.td,{children:"Remote communication is enabled and expected"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"when-to-use",children:"When to Use"}),"\n",(0,r.jsx)(s.p,{children:"Use Live Mode for:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"All real user interactions"}),"\n",(0,r.jsx)(s.li,{children:"Data that must persist and synchronize"}),"\n",(0,r.jsx)(s.li,{children:"Production workflows"}),"\n",(0,r.jsx)(s.li,{children:"Any operation that requires server communication"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"ghost-mode",children:"Ghost Mode"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Ghost Mode"})," is a fully isolated, offline-safe environment."]}),"\n",(0,r.jsx)(s.h3,{id:"what-ghost-mode-does",children:"What Ghost Mode Does"}),"\n",(0,r.jsxs)(s.p,{children:["In Ghost Mode, Supastash ",(0,r.jsx)(s.strong,{children:"guarantees"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\ud83d\udeab ",(0,r.jsx)(s.strong,{children:"Zero network activity"})," \u2013 No server communication of any kind"]}),"\n",(0,r.jsxs)(s.li,{children:["\ud83d\udeab ",(0,r.jsx)(s.strong,{children:"No background sync loops"})," \u2013 Sync engine is completely disabled"]}),"\n",(0,r.jsxs)(s.li,{children:["\ud83d\udeab ",(0,r.jsx)(s.strong,{children:"No realtime subscriptions"})," \u2013 No live data updates"]}),"\n",(0,r.jsxs)(s.li,{children:["\ud83d\udeab ",(0,r.jsx)(s.strong,{children:"No remote polling"})," \u2013 No periodic checks to the server"]}),"\n",(0,r.jsxs)(s.li,{children:["\ud83d\udeab ",(0,r.jsx)(s.strong,{children:"No server access"})," \u2013 Complete network isolation"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"database-isolation",children:"Database Isolation"}),"\n",(0,r.jsxs)(s.p,{children:["Ghost Mode opens a ",(0,r.jsx)(s.strong,{children:"fully isolated local database channel"}),"."]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Important"}),(0,r.jsx)(s.br,{}),"\n","This database is ",(0,r.jsx)(s.strong,{children:"not"})," a clone of the Live Mode database.",(0,r.jsx)(s.br,{}),"\n","The Ghost database starts empty and remains uninitialized until you explicitly create schema, tables, or seed data."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Ghost Mode does ",(0,r.jsx)(s.strong,{children:"not"})," automatically provide:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u274c Table schemas from Live Mode"}),"\n",(0,r.jsx)(s.li,{children:"\u274c Triggers from Live Mode"}),"\n",(0,r.jsx)(s.li,{children:"\u274c Indices from Live Mode"}),"\n",(0,r.jsx)(s.li,{children:"\u274c Seed data from Live Mode"}),"\n",(0,r.jsx)(s.li,{children:"\u274c Migrations from Live Mode"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["If you need schema, triggers, or seed data in Ghost Mode, you must ",(0,r.jsx)(s.strong,{children:"explicitly create them yourself"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"data-characteristics",children:"Data Characteristics"}),"\n",(0,r.jsx)(s.p,{children:"Any data written in Ghost Mode:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Never syncs to the server"}),"\n",(0,r.jsx)(s.li,{children:"Never affects live user data"}),"\n",(0,r.jsx)(s.li,{children:"Remains fully isolated from Live Mode"}),"\n",(0,r.jsxs)(s.li,{children:["Should be treated as ",(0,r.jsx)(s.strong,{children:"disposable"})]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"when-to-use-ghost-mode",children:"When to Use Ghost Mode"}),"\n",(0,r.jsx)(s.p,{children:"Ghost Mode is ideal for scenarios that require safe, isolated environments:"}),"\n",(0,r.jsx)(s.h3,{id:"perfect-use-cases",children:"Perfect Use Cases"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-markdown",children:"\u2713 In-app tutorials and walkthroughs\n\u2713 Guided onboarding flows\n\u2713 Feature demos and previews\n\u2713 Testing critical flows safely\n\u2713 Staging-like experiences in production apps\n\u2713 Offline-first prototyping\n"})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"example-scenario",children:"Example Scenario"}),"\n",(0,r.jsx)(s.p,{children:"A common use case for Ghost Mode is onboarding or tutorial flows where users interact with sample data."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'// Switch to Ghost Mode for tutorial execution\nawait reinitializeSupastash("ghost");\n\n// Explicitly initialize tutorial-only schema and data\nawait createGhostTables();\nawait seedTutorialData();\n\n// User interacts with tutorial data safely\n// No network access\n// No remote sync\n// No risk of affecting live data\n\n// Exit tutorial and return to Live Mode\nawait reinitializeSupastash("live");\n'})}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"mode-switching",children:"Mode Switching"}),"\n",(0,r.jsxs)(s.p,{children:["Switching modes requires ",(0,r.jsx)(s.strong,{children:"full reinitialization"})," through the dedicated function:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:"await reinitializeSupastash(mode: 'live' | 'ghost')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"what-happens-during-a-switch",children:"What Happens During a Switch"}),"\n",(0,r.jsx)(s.p,{children:"The reinitialization process follows these steps in order:"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Stop active sync loops"}),(0,r.jsx)(s.br,{}),"\n","All background synchronization processes are halted to prevent in-flight operations during the transition."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Unsubscribe from realtime channels"}),(0,r.jsx)(s.br,{}),"\n","All realtime subscriptions are explicitly terminated to guarantee no live connections remain active."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Update runtime configuration"}),(0,r.jsx)(s.br,{}),"\n","The Supastash runtime mode is updated in configuration. Direct mutation outside this process is unsupported."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Close the active database connection"}),(0,r.jsx)(s.br,{}),"\n","The current local database connection is safely closed to prevent cross-mode access."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Open a mode-specific database connection"}),(0,r.jsx)(s.br,{}),"\n","A new local database channel is initialized based on the resolved runtime mode."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Restart services when applicable"}),(0,r.jsx)(s.br,{}),"\n","Background sync and realtime services are restarted only when entering Live Mode."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["This process is ",(0,r.jsx)(s.strong,{children:"deterministic and safe"}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"rules-and-guarantees",children:"Rules and Guarantees"}),"\n",(0,r.jsx)(s.h3,{id:"invariants",children:"Invariants"}),"\n",(0,r.jsxs)(s.p,{children:["These rules ",(0,r.jsx)(s.strong,{children:"must always"})," be followed:"]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Rule"}),(0,r.jsx)(s.th,{children:"Consequence of Violation"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:["Runtime mode must ",(0,r.jsx)(s.strong,{children:"never"})," be mutated directly"]}),(0,r.jsx)(s.td,{children:"Undefined behavior, data corruption"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"reinitializeSupastash()"})," is the ",(0,r.jsx)(s.strong,{children:"only"})," supported way to change modes"]}),(0,r.jsx)(s.td,{children:"No guarantees outside this function"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"guarantees-you-can-rely-on",children:"Guarantees You Can Rely On"}),"\n",(0,r.jsx)(s.p,{children:"When you follow the rules above, Supastash guarantees:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Mode isolation"}),": Ghost and Live databases never interfere with each other"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Sync preservation"}),": Live sync operations survive mode switches"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Network safety"}),": Ghost Mode will never make network requests"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Deterministic switching"}),": Mode changes are predictable and repeatable"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"No data loss"}),": Pending operations are never discarded"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Aspect"}),(0,r.jsx)(s.th,{children:"Live Mode"}),(0,r.jsx)(s.th,{children:"Ghost Mode"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Purpose"})}),(0,r.jsx)(s.td,{children:"Real data, real users, real sync"}),(0,r.jsx)(s.td,{children:"Testing, tutorials, sandboxed experiences"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Database"})}),(0,r.jsx)(s.td,{children:"Live channel"}),(0,r.jsx)(s.td,{children:"Isolated ghost channel"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Sync"})}),(0,r.jsx)(s.td,{children:"\u2705 Active"}),(0,r.jsx)(s.td,{children:"\ud83d\udeab Disabled"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Realtime"})}),(0,r.jsx)(s.td,{children:"\u2705 Active"}),(0,r.jsx)(s.td,{children:"\ud83d\udeab Disabled"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Data persistence"})}),(0,r.jsx)(s.td,{children:"\u2705 Synced to server"}),(0,r.jsx)(s.td,{children:"\u274c Local only, disposable"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Schema"})}),(0,r.jsx)(s.td,{children:"\u2705 Auto-managed"}),(0,r.jsx)(s.td,{children:"\u274c Manual setup required"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h3,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Live Mode"})," is for real data, real users, and real sync."]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Ghost Mode"})," is a sandboxed, offline-safe environment for testing, tutorials, and controlled experiences."]}),"\n"]}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Mode switching"})," is explicit, destructive, and safe by design."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["This strict separation is ",(0,r.jsx)(s.strong,{children:"intentional and required"})," for Supastash to remain reliable at scale."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>l});var i=n(6540);const r={},t=i.createContext(r);function a(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);